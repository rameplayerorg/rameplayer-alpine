# Maintainer: Timo Ter√§s <timo.teras@iki.fi>
pkgname=rameplayer
pkgver=1.0.2
pkgrel=0
pkgdesc="Rameplayer configuration"
url="https://github.com/rameplayerorg/rameplayer-alpine"
arch="noarch"
license="GPLv2"
depends="tzdata openssh rsync dhcpcd eudev dbus
	raspberrypi alsa-utils ffmpeg omxplayer lua-cqueues-pushy
	rameplayer-webui rameplayer-backend
	"
replaces="alpine-baselayout alpine-conf busybox-initscripts dhcpcd openssh openrc"
replaces_priority="10"
makedepends=""
install=""
subpackages=""

source="interfaces
	modules
	dhcpcd.conf
	ntp.conf
	ntpd.confd
	rpi.conf
	httpd.confd
	lbu.conf
	rame-upgrade-firmware
	rame.list.lbu
	sshd_config
	wolfson.rules
	wolfson.sh
	udhcpd.conf
	udhcpd.confd
	rame-eth0
	rc.conf
	"

prepare() {
	:
}

build() {
	:
}

rc_add() {
	mkdir -p "$pkgdir"/etc/runlevels/"$2"
        ln -sf /etc/init.d/"$1" "$pkgdir"/etc/runlevels/"$2"/"$1"
}

package() {
	install -D -m644 interfaces "$pkgdir"/etc/networking/interfaces
	install -D -m644 modules "$pkgdir"/etc/modules
	install -D -m644 dhcpcd.conf "$pkgdir"/etc/dhcpcd.conf
	install -D -m644 ntp.conf "$pkgdir"/etc/ntp.conf
	install -D -m644 ntpd.confd "$pkgdir"/etc/conf.d/ntpd
	install -D -m644 rpi.conf "$pkgdir"/etc/modprobe.d/rpi.conf
	install -D -m644 httpd.confd "$pkgdir"/etc/conf.d/httpd
	install -D -m644 lbu.conf "$pkgdir"/etc/lbu/lbu.conf
	install -D -m755 rame-upgrade-firmware "$pkgdir"/sbin/rame-upgrade-firmware
	install -D -m644 sshd_config "$pkgdir"/etc/ssh/sshd_config
	install -D -m644 wolfson.rules "$pkgdir"/lib/udev/rules.d/90-wolfson.rules
	install -D -m755 wolfson.sh "$pkgdir"/usr/libexec/wolfson/wolfson.sh
	install -D -m644 rc.conf "$pkgdir"/etc/rc.conf
	install -D -m644 udhcpd.conf "$pkgdir"/etc/udhcpd.conf
	install -D -m644 udhcpd.confd "$pkgdir"/etc/conf.d/udhcpd
	install -D -m755 rame-eth0 "$pkgdir"/etc/init.d/rame-eth0
	install -D -m755 rame.list.lbu "$pkgdir"/etc/apk/protected_paths.d/rame.list

	mkdir -p "$pkgdir"/etc/cqpushy/
	ln -s /usr/share/rameplayer-backend/rameplayer.lua "$pkgdir"/etc/cqpushy/cqpushy.lua

	rc_add hwdrivers default
	rc_add ntpd default
	rc_add httpd default
	rc_add cqpushy default
	rc_add sshd default
	rc_add networking default
	rc_add dhcpcd default
	rc_add devfs sysinit
	rc_add dmesg sysinit
	rc_add modloop sysinit
	rc_add udev sysinit
	rc_add udev-trigger sysinit
	rc_add udev-postmount sysinit 
	rc_add modules boot
	rc_add sysctl boot
	rc_add hostname boot
	rc_add bootmisc boot
	rc_add syslog boot
	rc_add mount-ro shutdown
	rc_add killprocs shutdown
	rc_add savecache shutdown
}

md5sums="2892f43477bf99c9dd76141a347ef5c8  interfaces
b33dea15c06d5cd9184cd943e514362c  modules
b4e0154d90a826f679ca52db9d80425b  dhcpcd.conf
5c2d7b30a3e4c8f6c021fc14d0ece904  ntp.conf
95a9dd8d9f0b78a810c2b05eb0b39f1b  ntpd.confd
a5f3259412e2cf50b6a43b3b55f2dfd9  rpi.conf
42e5da277b126b5f3b4cea9bce5138d4  httpd.confd
984e979c6ed96f98d63cda0706780dfe  lbu.conf
b7848429067114ac418071ddca215069  rame-upgrade-firmware
5ff78472b24029a56162a2c31841a541  rame.list.lbu
5e67152f41f19a64dc8e3fe27a6fc5a7  sshd_config
39514f75405235d7c1e1af0d514c5143  wolfson.rules
10e8f2563058d35ff9d54e770c5c6b58  wolfson.sh
d7da1766227e07822c3e3655c1150d89  udhcpd.conf
cf14a6fd9c5a69518bd059154c7cf072  udhcpd.confd
55d06674e06769774033ad1fdc17a84e  rame-eth0
2aa70aaf110c29102066175146f784bb  rc.conf"
sha256sums="3157c93d752a8e3e26d564abf4f92b2b4c0236ff478367c81add68bb9d1ef3ca  interfaces
a0122aef4832a599c2129ee9d8df2d988e76ab1521ad0185e660e6b917697d77  modules
f2a34fe5d034cc7844072a01fe15d8ade58cf0ea81faed6aa842f47b23cf1600  dhcpcd.conf
299f43f1a6b39773e6bf0c11e23e9fe0048d3b54dd46d26732abb41bc528e946  ntp.conf
f792766afae281f18dcc96334f7f2717c9d41d842ac6041ef88ccce8be2634da  ntpd.confd
c5a448381304ec8b1a714f6f23c18ac108b899e4a9f9e3247c96835ca4d600c4  rpi.conf
198103cc212b855c606f28b6ea991360102b524a3aca22c0405f8ae486407221  httpd.confd
8a8645340d730ca1df3754917493cbc5c01c3c3e544dc362ea89351f721c1c68  lbu.conf
cced418097316e2b713a3c2853bbb10e1146385d037aeee21154f4e9194e7b57  rame-upgrade-firmware
8116db6b8ac149f2e3d68ad5d799319da4e3617795d220268042727f3a19a49f  rame.list.lbu
6e079cb7ab6c91a60777b93de1b75ef3c9251c2fedf44e0a38200fc2a104f4d9  sshd_config
872deb982c1b4a1bbec4a6bc47dc7a4411bee72520456f1f05d88195fb33d65f  wolfson.rules
b7c6744371304f6eddead73c99d45e5383b7f2329a7ba6e68b5d4616ce770537  wolfson.sh
aa970a8d1012c77871bbe6bb9a082b146eb8353bea19b634cef44617a58d4179  udhcpd.conf
fecf7c052bf8c13489e9faccec0cf887d87774d3ffe3537944a222c0aca972df  udhcpd.confd
df912699d755d6872357d7da906f94c44ed3b1dd17ad58482de29794634dbf1a  rame-eth0
60206c1f2b0026761303307dcab2e730f03252cc7d5e43565117b2bfd0a91189  rc.conf"
sha512sums="014f182397a9609aa8420f88d5c8430d6fc547186cf71264fec5a48cf97e1d8c76398cdc09f16db6bd22d3452ea419e36d6db5b715e81a0c33bf10f9eddca59a  interfaces
ca76b0ba2c01eccce24b9ba6289a3cca45dd0c875ad431b3dab3c8e70f842f78137e83b4ed4792ede02fce6c2201a1ca166dbdd85adf7ee682ad6fe6bccd67be  modules
cffbb809df40d478c611b48f0f6fb87eb389113e317e1fffc3e9f388548f21cf9a43afa54dcc27bd75a326801d655d0270447aeb3d19a4e55278f074d7fa876b  dhcpcd.conf
3fa49a3bd0dcb13e526a634f605d967f78527470233f456fd7ba83d8e72f9c471de398a83e9ab84879d0cd468346feba9f9a3c2f7df708a9b18d4b8729aeae07  ntp.conf
0b8f266bee4d941c67564abbeb26c627bc1d8418b1b4a07a8c549dfc615e406f54750247c05b9d4dbe197682496d11934404d4b2095c4d96f0af4ce248a6ed3b  ntpd.confd
c44e1370a4fb57574e16d20db29744a444b814055243d07b2652d20d1d6c42efb45880caab6740034e3a096663701286f1577282fec1b39d609ed03261ed52b6  rpi.conf
d3e72cd7f7d2b40cbfe10a0b847bda9960339a5bc450feba503d986b19dd247f5fc7972c1951cfde5e3357f5cefb2921f05291243d98e7373fea0cd9c3d4d3fa  httpd.confd
ea91cccbc8b91b7e57ebbb587fdca35497ddfbce4c9ec1404ec5277cc35615874dbb182df3f9ef63b19ced969c34fa80d3e4cf0f404bdc920e05a650cf499b52  lbu.conf
e332b2f87988a07aaaaf088a0e69c2179a88a67788cf4ba3a78fa2f7f7dd7252763322c9a88c6b5f7555c3044674fcbffa35a0e97e417fe249759ce6a0ce1b76  rame-upgrade-firmware
20a54accffe6b259164d9ad10ff707cf20f28403df9a516f7dd89ad1a86043991c18678cf3aae3abbd1481b19a5474b74587f74b1560df81eeafa88b185cbb46  rame.list.lbu
881e5473265cb325a2a7c3d7679a4d9a2eaf0052742d682cdece05c9d884f319b33236725a22e5a71d8b4b06006ac2befa4639e72d87da5a0eef5e46a598aff6  sshd_config
a58c7398894ecabe3b56d842748620c429e324d14a1252de55664f98153afab9a1283378ccaf0ddd91eebc5c612523b47982af5ec1f683b6ea0560b0d1f2950e  wolfson.rules
1bce1aea1374093ba084532586e3ec97812fb2ca1e87945d392e2bbbf49f08ccd81cb38e472181197dde13a079c89ec2447dc7d0730d6a0950142c3f392089b5  wolfson.sh
214c6e19f28923bc38d284ffb9e788cb7255c670ff1a89b3e19dc76f8d357711dacc30898a7284c6223a59cb031384d84151b6ffdd5fb150ca73f486753deb55  udhcpd.conf
8e926df006786348955893ec34eeab1da0c2bfb024fb0b04366b040ea9a1ac315d76b959a718cd30f68098cc43610231c4c766a246b566a1546d8f415cd4984e  udhcpd.confd
e6a86ece1cc2d6996009a0c90a9d37f6af49f7bfc90feea4bada5d5fd30c1517627e2a83df0978a397d2e834cf2c5605ae7a0884bc8a71332bc7ad2282d57ceb  rame-eth0
aafa0f02b06e31ee2afe0c66c017fb911ae897ae85080c0bc5668dc8360c8ed85c783aea59e5a7c12ea8d82734ea04d1efc6215d3012ba637d7d06746ea4e106  rc.conf"
